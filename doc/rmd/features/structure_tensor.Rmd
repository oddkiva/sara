## Corner and Junction Detection

The corner detection relies on the analysis of one statistical object called the
structure tensor.

In each point of the image, we want to describe its shape locally on a
small region.

The structure tensor summarizes the principal gradient directions and enables us
to classify each of these small regions into three categories:

1. Is it a uniform region?
2. Is the small region more like an edge? Can we calculate its orientation?
3. Is the small region more like a corner? Can we calculate its orientation?

Thus we build the structure tensor by accumulating all the image gradients into
a second moment matrix.

### Structure Tensor

Formally we define the field of structure tensors as

\begin{equation}
  \mathbf{M}(\mathbf{x}) = \begin{bmatrix}
    \displaystyle \int w(\mathbf{u}) \left( \frac{\partial I (\mathbf{x} -
    \mathbf{u})}{\partial x} \right)^2 d\mathbf{u}&&
    %
    \displaystyle \int w(\mathbf{u})
    \frac{\partial I(\mathbf{x} - \mathbf{u})}
         {\partial x}
    \frac{\partial I(\mathbf{x} - \mathbf{u})}
         {\partial y} d\mathbf{x}'\\
    %
    \displaystyle \int w(\mathbf{u})
    \frac{\partial I(\mathbf{x} - \mathbf{u})}
         {\partial x}
    \frac{\partial I(\mathbf{x} - \mathbf{u})}
         {\partial y} d\mathbf{u} &&
    %
    \displaystyle \int w(\mathbf{u}) \left( \frac{\partial I (\mathbf{x} -
    \mathbf{u})}{\partial y} \right)^2 d\mathbf{u}&&
  \end{bmatrix}
\end{equation}

More tersely, in functional notations with the $*$ symbol to denote a
convolution operation
\begin{equation}
  \mathbf{M} = \begin{bmatrix}
    w * \left( \frac{\partial I}{\partial x} \right)^2 &&
    %
    w *
    \left( \frac{\partial I}{\partial x} \frac{\partial I} {\partial y} \right) \\
    %
    w *
    \left( \frac{\partial I}{\partial x} \frac{\partial I} {\partial y} \right) &&
    %
    w *
    \left( \frac{\partial I}{\partial y} \right)^2
  \end{bmatrix}
\end{equation}

With a bit of linear algebra, we can rewrite this as

\begin{equation}
  \mathbf{M} = w * \left( \nabla I\ \nabla I^T \right)
\end{equation}

This form is convenient from an implementation point of view.

By extracting the eigenvalues and eigenvectors, we can calculate the two
principal directions of the gradients, that is, those that appears most
frequently, and then compare the "frequency" ratio between the two principal
directions.

If the local patch center on the point is a uniform region. The gradients are
very small, the covariance matrix should be close to zero.

If the local patch center on the point is on an edge. The covariance matrix
should correspond to a very elongated ellipse geometrically. The ratio between
the lowest and highest eigenvalues should be very small.

If the local patch center on the point is on a corner. Then covariance matrix
should correspond to a large circle. The ratio between the lowest and highest
eigenvalues should be close to 1.


We should note that in practice the image is first convolved with a Gaussian
kernel of standard deviation $\sigma_D$. This is to reduce the aliasing and
image noise.

\begin{equation}
  \mathbf{M} = g_{\sigma_I} * \left( \nabla I_{\sigma_D} * \ \nabla I_{\sigma_D}^T \right)
\end{equation}
where the convolved image with a gaussian kernel is denoted as
\begin{equation}
  I_{\sigma_D} = g_{\sigma_D} * I
\end{equation}


### Spiral Model

I learnt from [@ForstnerDS:2009:iccv] that the spiral model is an extension of
the structure tensor. This time, the structure is also parameterized with a 2D
rotation matrix parameterized by an angle $\alpha$ in the structure tensor.

\begin{equation}
  \mathbf{M}(\alpha) = w *
  \mathbf{R}_\alpha \nabla I \nabla I^T \mathbf{R}_\alpha^T
\end{equation}

